{# templates/_macros.html #}
{% macro alerts_list(alerts) -%}
  {% if alerts and alerts|length > 0 %}
  <div class="alert alert-warning">
    <strong>Réassort :</strong>
    <ul class="mb-0">
      {% for a in alerts %}
        <li>
          {{ a.product.name }}
          {% if a.variant.size_l %} — {{ a.variant.size_l }} L{% endif %} :
          manque {{ a.missing }} (stock {{ a.inv_qty }}/min {{ a.min_qty }})
        </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
{%- endmacro %}

{% macro equipment_badges(eq) -%}
  {% if not eq %}{% set eq = {} %}{% endif %}
  {% set t = eq.tireuse or 0 %}
  {% set c2 = eq.co2 or 0 %}
  {% set cpt = eq.comptoir or 0 %}
  {% set ton = eq.tonnelle or 0 %}
  <div class="equip-badges">
    {% if t > 0 %}<span class="badge badge-eq">Tireuse × {{ t }}</span>{% endif %}
    {% if c2 > 0 %}<span class="badge badge-eq">CO₂ × {{ c2 }}</span>{% endif %}
    {% if cpt > 0 %}<span class="badge badge-eq">Comptoir × {{ cpt }}</span>{% endif %}
    {% if ton > 0 %}<span class="badge badge-eq">Tonnelle × {{ ton }}</span>{% endif %}
  </div>
{%- endmacro %}

{# NOUVEAU : badges de consigne séparées Fûts / Gobelets #}
{% macro deposit_split_badges(card) -%}
  {# Valeurs tolérantes si clés manquantes #}
  {% set keg_eur = (card.deposit_keg_eur or 0) | round(2) %}
  {% set keg_qty = card.keg_qty_in_play or 0 %}
  {% set cup_eur = (card.deposit_cup_eur or 0) | round(2) %}
  {% set cup_qty = card.cup_qty_in_play or 0 %}
  <div class="consigne-badges">
    <span class="badge badge-keg" title="Consigne fûts (€) et nombre en jeu">
      Fûts : {{ keg_eur }} € ({{ keg_qty }})
    </span>
    <span class="badge badge-cup" title="Consigne gobelets (€) et nombre en jeu">
      Gobelets : {{ cup_eur }} € ({{ cup_qty }})
    </span>
  </div>
{%- endmacro %}
