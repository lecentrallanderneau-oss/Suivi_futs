{# templates/_macros.html #}
{% macro eur(x) -%}{{ ('%.2f' % (x or 0)) }} €{%- endmacro %}

{% macro equipment_badges(eq_in) %}
  {% set eq = eq_in or {} %}
  {% set t = eq.get('tireuse', 0) %}
  {% set co2 = eq.get('co2', 0) %}
  {% set cpt = eq.get('comptoir', 0) %}
  {% set ton = eq.get('tonnelle', 0) %}
  {% set total = (t or 0) + (co2 or 0) + (cpt or 0) + (ton or 0) %}
  {% if total > 0 %}
    <span class="pill">{{ 'tireuse : %s' % (t or 0) }}</span>
    <span class="pill">{{ 'co2 : %s' % (co2 or 0) }}</span>
    <span class="pill">{{ 'comptoir : %s' % (cpt or 0) }}</span>
    <span class="pill">{{ 'tonnelle : %s' % (ton or 0) }}</span>
  {% else %}
    <span class="muted">Aucun matériel en prêt</span>
  {% endif %}
{% endmacro %}

{% macro alerts_list(alerts) %}
  {% if alerts and alerts|length %}
    <div class="alert alert-warn">
      <strong>Seuils mini :</strong>
      <ul class="alert-list">
        {% for a in alerts %}
          <li>
            {{ a.product.name }}
            {% if a.variant.size_l %} — {{ a.variant.size_l }} L{% endif %}
            : stock {{ a.current }} &lt; mini {{ a.min }}
          </li>
        {% endfor %}
      </ul>
    </div>
  {% endif %}
{% endmacro %}
